hairType3 <- unique(hairType3)
hairType3
dat
set.seed(123)
# Create a dataset that is essentially in wide (kinda- reduce data dimmension)
dat2 <- dat %>%
group_by(ID) %>%
summarise(Hair_Type = unique(Hair_Type),
Sex = unique(Sex))
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(comment = NULL)
knitr::opts_chunk$set(warning = FALSE)
library(tidyverse)
library(ggplot2)
library(readxl)
library(kableExtra)
library(lme4)
library(lmerTest)
# Set the working directory
CSVs_Location = '//files.times.uh.edu/Labs/Grigorenko_ONR-MPAB/NEUROIMAGING_PILOT/Data/'
setwd(CSVs_Location)
# Load in the data
dryEEG <- read_excel("REPORTS/DryEEG_Report.xlsx")
wetEEG <- read_excel("REPORTS/WetEEG_Report.xlsx")
hairType <- read.csv("FINAL_DS/HAIR_TYPE/Neuroimaging PilotIDs.csv")
demo <- read.csv("FINAL_DS/DEMOGRAPHICS/Demographics.csv")
# Bind the data together
dat <- rbind(dryEEG, wetEEG)
# Select vars of interest for the hair
hairType2 <- select(hairType, ID = ParticipantID, Hair_Type = Hair.Type, email = Email)
# Select vars of interest from demo
demo2 <- select(demo, email = Q2, Sex = Q1.1)
# Combine hair and demo info
hairType3 <- hairType2 %>%
left_join(demo2, by = "email")
# Remove redundancy from the data (Someone did the screener twice)
hairType3 <- unique(hairType3)
# Add an ID Variable
dat$ID <- sapply(str_split(dat$File_Name, "_"), function(x) x[1])
dat$ID <- as.numeric(dat$ID)
# Add a condition variable
dat$Condition <- sapply(str_split(dat$File_Name, "_"), function(x) x[2])
# Add a EEG system variable
dat$EEGSys <- gsub(".vhdr", "", sapply(str_split(dat$File_Name, "_"), function(x) x[3]))
# Merge Hair Data to this
dat <- dat %>%
left_join(hairType3, by = "ID")
# Change order of vars
dat <- select(dat, Date, File_Name, ID, Condition, EEGSys, Hair_Type, everything())
view(dat)
set.seed(123)
# Create a dataset that is essentially in wide (kinda- reduce data dimmension)
dat2 <- dat %>%
group_by(ID) %>%
summarise(Hair_Type = unique(Hair_Type),
Sex = unique(Sex))
# Plot this
dat %>%
mutate(Percent_Remaining_Round = round(Percent_Remaining),
Percent_Remaining_label = paste0(Percent_Remaining_Round,"%"),
EEGSys = ifelse(EEGSys == "DE", "Dry", "Wet"),
Condition = ifelse(Condition == "EO", "Eyes-Open", "Eyes-Closed"),
Hair_Type_n = ifelse(Hair_Type == "Type 1",
paste0("Type 1 (n=",sum(dat2$Hair_Type == "Type 1"),")"),
paste0("Type 2 (n=",sum(dat2$Hair_Type == "Type 2"), ")")),
Sex_n = ifelse(Sex == "Male",
paste0("Male (n=", sum(dat2$Sex == "Male", na.rm = T), ")"),
paste0("Female (n=", sum(dat2$Sex == "Female", na.rm = T), ")")
)) %>%
ggplot(aes(x = EEGSys, y = Percent_Remaining_Round, color = Hair_Type_n, shape = Sex_n)) +
facet_wrap(~Condition) +
geom_jitter(width = .2) +
theme_classic() +
geom_hline(yintercept= 5, linetype="dashed", color = "red") +
labs(title = "Usable EEG Data (%) By Hair Type, Eyes Condition, and EEG System",
x = "EEG System",
y = "Usable EEG Data (%)",
caption = "Red line (cut-off) was set to 5%")
# Set a threshold
Threshold = 5
# Filter those who poor data
poor_data <- filter(dat, Percent_Remaining < Threshold )
# Paste results
paste0("There are ",length(unique(poor_data$ID)), " subjects out of ", length(unique(dat$ID))," whose EEG data is less than 5% usable")
paste0("These IDs are: ", paste(unique(poor_data$ID), collapse = ", "))
dat_DE <- dat %>%
select(ID, Condition, EEGSys, Hair_Type, Sex, Percent_Remaining) %>%
filter(EEGSys == "DE") %>%
pivot_wider(names_from = Condition, values_from = Percent_Remaining) %>%
mutate(Data_Q = case_when(
EO < 10 & EC < 10 ~ "Bad",
EO < 70 & EC < 70 ~ "Okay",
EO >= 70 & EC >= 70 ~ "Good",
TRUE ~ "Other"
))
table(dat_DE$Data_Q)
view(dat_DE)
#
dat
mutate(rankScore = ifelse(EEG_Rank1/max(EEG_Rank1) < RankThreshold, "Low Rank", "Acceptable")
#
dat %>%
#
dat %>%
mutate(rankScore = ifelse(EEG_Rank1/max(EEG_Rank1) < RankThreshold, "Low Rank", "Acceptable"))
## Rank thereshold (prop)
RankThreshold = .7
#
dat %>%
mutate(rankScore = ifelse(EEG_Rank1/max(EEG_Rank1) < RankThreshold, "Low Rank", "Acceptable"))
# Create a score for EEG ranking acceptability
dat <- dat %>%
mutate(rankScore = ifelse(EEG_Rank1/max(EEG_Rank1) < RankThreshold, "Low Rank", "Acceptable"))
# Plot this
dat %>%
mutate(Percent_Remaining_Round = round(Percent_Remaining),
Percent_Remaining_label = paste0(Percent_Remaining_Round,"%"),
EEGSys = ifelse(EEGSys == "DE", "Dry", "Wet"),
Condition = ifelse(Condition == "EO", "Eyes-Open", "Eyes-Closed"),
Hair_Type_n = ifelse(Hair_Type == "Type 1",
paste0("Type 1 (n=",sum(dat2$Hair_Type == "Type 1"),")"),
paste0("Type 2 (n=",sum(dat2$Hair_Type == "Type 2"), ")")),
Sex_n = ifelse(Sex == "Male",
paste0("Male (n=", sum(dat2$Sex == "Male", na.rm = T), ")"),
paste0("Female (n=", sum(dat2$Sex == "Female", na.rm = T), ")")
)) %>%
ggplot(aes(x = EEGSys, y = Percent_Remaining_Round, color = Hair_Type_n, shape = rankScore)) +
facet_wrap(~Condition) +
geom_jitter(width = .2) +
theme_classic() +
geom_hline(yintercept= 5, linetype="dashed", color = "red") +
labs(title = "Usable EEG Data (%) By Hair Type, Eyes Condition, and EEG System",
x = "EEG System",
y = "Usable EEG Data (%)",
caption = "Red line (cut-off) was set to 5%")
# Plot this
dat %>%
mutate(Percent_Remaining_Round = round(Percent_Remaining),
Percent_Remaining_label = paste0(Percent_Remaining_Round,"%"),
EEGSys = ifelse(EEGSys == "DE", "Dry", "Wet"),
Condition = ifelse(Condition == "EO", "Eyes-Open", "Eyes-Closed"),
Hair_Type_n = ifelse(Hair_Type == "Type 1",
paste0("Type 1 (n=",sum(dat2$Hair_Type == "Type 1"),")"),
paste0("Type 2 (n=",sum(dat2$Hair_Type == "Type 2"), ")")),
Sex_n = ifelse(Sex == "Male",
paste0("Male (n=", sum(dat2$Sex == "Male", na.rm = T), ")"),
paste0("Female (n=", sum(dat2$Sex == "Female", na.rm = T), ")")
)) %>%
ggplot(aes(x = EEGSys, y = Percent_Remaining_Round, color = Hair_Type_n, shape = rankScore, size = rankScore)) +
facet_wrap(~Condition) +
geom_jitter(width = .2) +
theme_classic() +
geom_hline(yintercept= 5, linetype="dashed", color = "red") +
labs(title = "Usable EEG Data (%) By Hair Type, Eyes Condition, and EEG System",
x = "EEG System",
y = "Usable EEG Data (%)",
caption = "Red line (cut-off) was set to 5%")
dat$rankScore
set.seed(123)
# Create a dataset that is essentially in wide (kinda- reduce data dimmension)
dat2 <- dat %>%
group_by(ID) %>%
summarise(Hair_Type = unique(Hair_Type),
Sex = unique(Sex))
## Rank thereshold (prop)
RankThreshold = .7
# Create a score for EEG ranking acceptability
dat <- dat %>%
mutate(rankScore = ifelse(EEG_Rank1/max(EEG_Rank1) < RankThreshold, "Low Rank", "Acceptable"))
# Plot this
dat %>%
mutate(Percent_Remaining_Round = round(Percent_Remaining),
Percent_Remaining_label = paste0(Percent_Remaining_Round,"%"),
EEGSys = ifelse(EEGSys == "DE", "Dry", "Wet"),
Condition = ifelse(Condition == "EO", "Eyes-Open", "Eyes-Closed"),
Hair_Type_n = ifelse(Hair_Type == "Type 1",
paste0("Type 1 (n=",sum(dat2$Hair_Type == "Type 1"),")"),
paste0("Type 2 (n=",sum(dat2$Hair_Type == "Type 2"), ")")),
Sex_n = ifelse(Sex == "Male",
paste0("Male (n=", sum(dat2$Sex == "Male", na.rm = T), ")"),
paste0("Female (n=", sum(dat2$Sex == "Female", na.rm = T), ")")),
rankScore_n = ifelse(rankScore == "Acceptable",
paste0("Acceptable (n=", sum(dat2$rankScore == "Acceptable", na.rm = T), ")"),
paste0("Low Rank (n=", sum(dat2$Sex == "Low Rank", na.rm = T), ")"))
) %>%
ggplot(aes(x = EEGSys, y = Percent_Remaining_Round, color = Hair_Type_n, shape = rankScore_n)) +
facet_wrap(~Condition) +
geom_jitter(width = .2) +
theme_classic() +
geom_hline(yintercept= 5, linetype="dashed", color = "red") +
labs(title = "Usable EEG Data (%) By Hair Type, Eyes Condition, and EEG System",
x = "EEG System",
y = "Usable EEG Data (%)",
caption = "Red line (cut-off) was set to 5%")
# Set a threshold
Threshold = 5
# Filter those who poor data
poor_data <- filter(dat, Percent_Remaining < Threshold )
# Paste results
paste0("There are ",length(unique(poor_data$ID)), " subjects out of ", length(unique(dat$ID))," whose EEG data is less than 5% usable")
paste0("These IDs are: ", paste(unique(poor_data$ID), collapse = ", "))
set.seed(123)
# Create a score for EEG ranking acceptability
dat <- dat %>%
mutate(rankScore = ifelse(EEG_Rank1/max(EEG_Rank1) < RankThreshold, "Low Rank", "Acceptable"))
# Create a dataset that is essentially in wide (kinda- reduce data dimmension)
dat2 <- dat %>%
group_by(ID) %>%
summarise(Hair_Type = unique(Hair_Type),
Sex = unique(Sex),
rankScore = unique(rankScore))
## Rank thereshold (prop)
RankThreshold = .7
# Plot this
dat %>%
mutate(Percent_Remaining_Round = round(Percent_Remaining),
Percent_Remaining_label = paste0(Percent_Remaining_Round,"%"),
EEGSys = ifelse(EEGSys == "DE", "Dry", "Wet"),
Condition = ifelse(Condition == "EO", "Eyes-Open", "Eyes-Closed"),
Hair_Type_n = ifelse(Hair_Type == "Type 1",
paste0("Type 1 (n=",sum(dat2$Hair_Type == "Type 1"),")"),
paste0("Type 2 (n=",sum(dat2$Hair_Type == "Type 2"), ")")),
Sex_n = ifelse(Sex == "Male",
paste0("Male (n=", sum(dat2$Sex == "Male", na.rm = T), ")"),
paste0("Female (n=", sum(dat2$Sex == "Female", na.rm = T), ")")),
rankScore_n = ifelse(rankScore == "Acceptable",
paste0("Acceptable (n=", sum(dat2$rankScore == "Acceptable", na.rm = T), ")"),
paste0("Low Rank (n=", sum(dat2$Sex == "Low Rank", na.rm = T), ")"))
) %>%
ggplot(aes(x = EEGSys, y = Percent_Remaining_Round, color = Hair_Type_n, shape = rankScore_n)) +
facet_wrap(~Condition) +
geom_jitter(width = .2) +
theme_classic() +
geom_hline(yintercept= 5, linetype="dashed", color = "red") +
labs(title = "Usable EEG Data (%) By Hair Type, Eyes Condition, and EEG System",
x = "EEG System",
y = "Usable EEG Data (%)",
caption = "Red line (cut-off) was set to 5%")
# Set a threshold
Threshold = 5
# Filter those who poor data
poor_data <- filter(dat, Percent_Remaining < Threshold )
# Paste results
paste0("There are ",length(unique(poor_data$ID)), " subjects out of ", length(unique(dat$ID))," whose EEG data is less than 5% usable")
paste0("These IDs are: ", paste(unique(poor_data$ID), collapse = ", "))
set.seed(123)
# Create a score for EEG ranking acceptability
dat <- dat %>%
mutate(rankScore = ifelse(EEG_Rank1/max(EEG_Rank1) < RankThreshold, "Low Rank", "Acceptable"))
# Create a dataset that is essentially in wide (kinda- reduce data dimmension)
dat2 <- dat %>%
group_by(ID) %>%
summarise(Hair_Type = unique(Hair_Type),
Sex = unique(Sex),
rankScore)
## Rank thereshold (prop)
RankThreshold = .7
# Plot this
dat %>%
mutate(Percent_Remaining_Round = round(Percent_Remaining),
Percent_Remaining_label = paste0(Percent_Remaining_Round,"%"),
EEGSys = ifelse(EEGSys == "DE", "Dry", "Wet"),
Condition = ifelse(Condition == "EO", "Eyes-Open", "Eyes-Closed"),
Hair_Type_n = ifelse(Hair_Type == "Type 1",
paste0("Type 1 (n=",sum(dat2$Hair_Type == "Type 1"),")"),
paste0("Type 2 (n=",sum(dat2$Hair_Type == "Type 2"), ")")),
Sex_n = ifelse(Sex == "Male",
paste0("Male (n=", sum(dat2$Sex == "Male", na.rm = T), ")"),
paste0("Female (n=", sum(dat2$Sex == "Female", na.rm = T), ")")),
rankScore_n = ifelse(rankScore == "Acceptable",
paste0("Acceptable (n=", sum(dat2$rankScore == "Acceptable", na.rm = T), ")"),
paste0("Low Rank (n=", sum(dat2$Sex == "Low Rank", na.rm = T), ")"))
) %>%
ggplot(aes(x = EEGSys, y = Percent_Remaining_Round, color = Hair_Type_n, shape = rankScore_n)) +
facet_wrap(~Condition) +
geom_jitter(width = .2) +
theme_classic() +
geom_hline(yintercept= 5, linetype="dashed", color = "red") +
labs(title = "Usable EEG Data (%) By Hair Type, Eyes Condition, and EEG System",
x = "EEG System",
y = "Usable EEG Data (%)",
caption = "Red line (cut-off) was set to 5%")
# Set a threshold
Threshold = 5
# Filter those who poor data
poor_data <- filter(dat, Percent_Remaining < Threshold )
# Paste results
paste0("There are ",length(unique(poor_data$ID)), " subjects out of ", length(unique(dat$ID))," whose EEG data is less than 5% usable")
paste0("These IDs are: ", paste(unique(poor_data$ID), collapse = ", "))
table(dat$rankScore)
dat2$rankScore
# Create a dataset that is essentially in wide (kinda- reduce data dimmension)
dat2 <- dat %>%
group_by(ID) %>%
summarise(Hair_Type = unique(Hair_Type),
Sex = unique(Sex),
rankScore = unique(rankScore))
dat2$rankScore
set.seed(123)
# Create a score for EEG ranking acceptability
dat <- dat %>%
mutate(rankScore = ifelse(EEG_Rank1/max(EEG_Rank1) < RankThreshold, "Low_Rank", "Acceptable"))
# Create a dataset that is essentially in wide (kinda- reduce data dimmension)
dat2 <- dat %>%
group_by(ID) %>%
summarise(Hair_Type = unique(Hair_Type),
Sex = unique(Sex),
rankScore = unique(rankScore))
## Rank thereshold (prop)
RankThreshold = .7
# Plot this
dat %>%
mutate(Percent_Remaining_Round = round(Percent_Remaining),
Percent_Remaining_label = paste0(Percent_Remaining_Round,"%"),
EEGSys = ifelse(EEGSys == "DE", "Dry", "Wet"),
Condition = ifelse(Condition == "EO", "Eyes-Open", "Eyes-Closed"),
Hair_Type_n = ifelse(Hair_Type == "Type 1",
paste0("Type 1 (n=",sum(dat2$Hair_Type == "Type 1"),")"),
paste0("Type 2 (n=",sum(dat2$Hair_Type == "Type 2"), ")")),
Sex_n = ifelse(Sex == "Male",
paste0("Male (n=", sum(dat2$Sex == "Male", na.rm = T), ")"),
paste0("Female (n=", sum(dat2$Sex == "Female", na.rm = T), ")")),
rankScore_n = ifelse(rankScore == "Acceptable",
paste0("Acceptable (n=", sum(dat2$rankScore == "Acceptable", na.rm = T), ")"),
paste0("Low Rank (n=", sum(dat2$rankScore == "Low_Rank", na.rm = T), ")"))
) %>%
ggplot(aes(x = EEGSys, y = Percent_Remaining_Round, color = Hair_Type_n, shape = rankScore_n)) +
facet_wrap(~Condition) +
geom_jitter(width = .2) +
theme_classic() +
geom_hline(yintercept= 5, linetype="dashed", color = "red") +
labs(title = "Usable EEG Data (%) By Hair Type, Eyes Condition, and EEG System",
x = "EEG System",
y = "Usable EEG Data (%)",
caption = "Red line (cut-off) was set to 5%")
# Set a threshold
Threshold = 5
# Filter those who poor data
poor_data <- filter(dat, Percent_Remaining < Threshold )
# Paste results
paste0("There are ",length(unique(poor_data$ID)), " subjects out of ", length(unique(dat$ID))," whose EEG data is less than 5% usable")
paste0("These IDs are: ", paste(unique(poor_data$ID), collapse = ", "))
table(dat2$rankScore)
nrow(dat)
set.seed(123)
# Create a score for EEG ranking acceptability
dat <- dat %>%
mutate(rankScore = ifelse(EEG_Rank1/max(EEG_Rank1) < RankThreshold, "Low_Rank", "Acceptable"))
# Create a dataset that is essentially in wide (kinda- reduce data dimmension)
dat2 <- dat %>%
group_by(ID) %>%
summarise(Hair_Type = unique(Hair_Type),
Sex = unique(Sex),
rankScore = unique(rankScore)/2)
set.seed(123)
# Create a score for EEG ranking acceptability
dat <- dat %>%
mutate(rankScore = ifelse(EEG_Rank1/max(EEG_Rank1) < RankThreshold, "Low_Rank", "Acceptable"))
# Create a dataset that is essentially in wide (kinda- reduce data dimmension)
dat2 <- dat %>%
group_by(ID) %>%
summarise(Hair_Type = unique(Hair_Type),
Sex = unique(Sex),
rankScore = unique(rankScore))
## Rank thereshold (prop)
RankThreshold = .7
# Plot this
dat %>%
mutate(Percent_Remaining_Round = round(Percent_Remaining),
Percent_Remaining_label = paste0(Percent_Remaining_Round,"%"),
EEGSys = ifelse(EEGSys == "DE", "Dry", "Wet"),
Condition = ifelse(Condition == "EO", "Eyes-Open", "Eyes-Closed"),
Hair_Type_n = ifelse(Hair_Type == "Type 1",
paste0("Type 1 (n=",sum(dat2$Hair_Type == "Type 1"),")"),
paste0("Type 2 (n=",sum(dat2$Hair_Type == "Type 2"), ")")),
Sex_n = ifelse(Sex == "Male",
paste0("Male (n=", sum(dat2$Sex == "Male", na.rm = T), ")"),
paste0("Female (n=", sum(dat2$Sex == "Female", na.rm = T), ")")),
rankScore_n = ifelse(rankScore == "Acceptable",
paste0("Acceptable (n=", sum(dat2$rankScore == "Acceptable", na.rm = T), ")"),
paste0("Low Rank (n=", sum(dat2$rankScore == "Low_Rank", na.rm = T), ")"))
) %>%
ggplot(aes(x = EEGSys, y = Percent_Remaining_Round, color = Hair_Type_n, shape = rankScore_n)) +
facet_wrap(~Condition) +
geom_jitter(width = .2) +
theme_classic() +
geom_hline(yintercept= 5, linetype="dashed", color = "red") +
labs(title = "Usable EEG Data (%) By Hair Type, Eyes Condition, and EEG System",
x = "EEG System",
y = "Usable EEG Data (%)",
caption = "Red line (cut-off) was set to 5%")
# Set a threshold
Threshold = 5
# Filter those who poor data
poor_data <- filter(dat, Percent_Remaining < Threshold )
# Paste results
paste0("There are ",length(unique(poor_data$ID)), " subjects out of ", length(unique(dat$ID))," whose EEG data is less than 5% usable")
paste0("These IDs are: ", paste(unique(poor_data$ID), collapse = ", "))
set.seed(123)
# Create a score for EEG ranking acceptability
dat <- dat %>%
mutate(rankScore = ifelse(EEG_Rank1/max(EEG_Rank1) < RankThreshold, "Low_Rank", "Acceptable"))
# Create a dataset that is essentially in wide (kinda- reduce data dimmension)
dat2 <- dat %>%
group_by(ID) %>%
summarise(Hair_Type = unique(Hair_Type),
Sex = unique(Sex))
## Rank thereshold (prop)
RankThreshold = .7
# Plot this
dat %>%
mutate(Percent_Remaining_Round = round(Percent_Remaining),
Percent_Remaining_label = paste0(Percent_Remaining_Round,"%"),
EEGSys = ifelse(EEGSys == "DE", "Dry", "Wet"),
Condition = ifelse(Condition == "EO", "Eyes-Open", "Eyes-Closed"),
Hair_Type_n = ifelse(Hair_Type == "Type 1",
paste0("Type 1 (n=",sum(dat2$Hair_Type == "Type 1"),")"),
paste0("Type 2 (n=",sum(dat2$Hair_Type == "Type 2"), ")")),
Sex_n = ifelse(Sex == "Male",
paste0("Male (n=", sum(dat2$Sex == "Male", na.rm = T), ")"),
paste0("Female (n=", sum(dat2$Sex == "Female", na.rm = T), ")")),
rankScore_n = ifelse(rankScore == "Acceptable",
paste0("Acceptable (n=", sum(dat$rankScore == "Acceptable", na.rm = T), ")"),
paste0("Low Rank (n=", sum(dat$rankScore == "Low_Rank", na.rm = T), ")"))
) %>%
ggplot(aes(x = EEGSys, y = Percent_Remaining_Round, color = Hair_Type_n, shape = rankScore_n)) +
facet_wrap(~Condition) +
geom_jitter(width = .2) +
theme_classic() +
geom_hline(yintercept= 5, linetype="dashed", color = "red") +
labs(title = "Usable EEG Data (%) By Hair Type, Eyes Condition, and EEG System",
x = "EEG System",
y = "Usable EEG Data (%)",
caption = "Red line (cut-off) was set to 5%")
# Set a threshold
Threshold = 5
# Filter those who poor data
poor_data <- filter(dat, Percent_Remaining < Threshold )
# Paste results
paste0("There are ",length(unique(poor_data$ID)), " subjects out of ", length(unique(dat$ID))," whose EEG data is less than 5% usable")
paste0("These IDs are: ", paste(unique(poor_data$ID), collapse = ", "))
set.seed(123)
# Create a score for EEG ranking acceptability
dat <- dat %>%
mutate(rankScore = ifelse(EEG_Rank1/max(EEG_Rank1) < RankThreshold, "Low_Rank", "Acceptable"))
# Subset data for low rank ppl
lowRank <- dat %>%
filter(rankScore == "Low_Rank" )
# Create a dataset that is essentially in wide (kinda- reduce data dimmension)
dat2 <- dat %>%
group_by(ID) %>%
summarise(Hair_Type = unique(Hair_Type),
Sex = unique(Sex))
## Rank thereshold (prop)
RankThreshold = .7
# Plot this
dat %>%
mutate(Percent_Remaining_Round = round(Percent_Remaining),
Percent_Remaining_label = paste0(Percent_Remaining_Round,"%"),
EEGSys = ifelse(EEGSys == "DE", "Dry", "Wet"),
Condition = ifelse(Condition == "EO", "Eyes-Open", "Eyes-Closed"),
Hair_Type_n = ifelse(Hair_Type == "Type 1",
paste0("Type 1 (n=",sum(dat2$Hair_Type == "Type 1"),")"),
paste0("Type 2 (n=",sum(dat2$Hair_Type == "Type 2"), ")")),
Sex_n = ifelse(Sex == "Male",
paste0("Male (n=", sum(dat2$Sex == "Male", na.rm = T), ")"),
paste0("Female (n=", sum(dat2$Sex == "Female", na.rm = T), ")")),
rankScore_n = ifelse(rankScore == "Acceptable",
paste0("Acceptable (n=", sum(dat$rankScore == "Acceptable", na.rm = T), ")"),
paste0("Low Rank (n=", sum(dat$rankScore == "Low_Rank", na.rm = T), ")"))
) %>%
ggplot(aes(x = EEGSys, y = Percent_Remaining_Round, color = Hair_Type_n, shape = rankScore_n)) +
facet_wrap(~Condition) +
geom_jitter(width = .2) +
theme_classic() +
geom_hline(yintercept= 5, linetype="dashed", color = "red") +
labs(title = "Usable EEG Data (%) By Hair Type, Eyes Condition, and EEG System",
x = "EEG System",
y = "Usable EEG Data (%)",
caption = "Red line (cut-off) was set to 5%")
# Set a threshold
Threshold = 5
# Filter those who poor data
poor_data <- filter(dat, Percent_Remaining < Threshold )
# Paste results
paste0("There are ",length(unique(poor_data$ID)), " subjects out of ", length(unique(dat$ID))," whose EEG data is less than 5% usable")
paste0("These IDs are: ", paste(unique(poor_data$ID), collapse = ", "))
paste0("These IDs:", paste(unique(lowRank$ID) ,"have low ranking EEG" )
paste(unique(lowRank$ID)
paste0("These IDs:", paste(unique(lowRank$ID)) ,"have low ranking EEG" )
paste0("These IDs are: ", paste(unique(poor_data$ID), collapse = ", "))
paste0("These IDs:", paste(unique(lowRank$ID)) ,"have low ranking EEG" )
paste0("These IDs:", paste(unique(lowRank$ID)), collapse = "", have low ranking EEG" )
paste0("These IDs:", paste(unique(lowRank$ID)), collapse = "", have low ranking EEG" )
paste0("These IDs:", paste(unique(lowRank$ID)), collapse = "", "have low ranking EEG" )
paste0("These IDs have low ranking EEG:", paste(unique(lowRank$ID), collapse = ""))
paste0("These IDs have low ranking EEG:", paste(unique(lowRank$ID), collapse = ", "))
paste0("These IDs have low ranking EEG: ", paste(unique(lowRank$ID), collapse = ", "))
names(poor_data2)
names(poor_data)
# Create a table of people with bad data and their hair typ
unique(c(unique(poor_data$ID),unique(lowRank$ID)))
# Create a table of people with bad data and their hair typ
allBadIDs = unique(c(unique(poor_data$ID),unique(lowRank$ID)));
dat
dat %>%
filter(ID %in% allBadIDs)
dat %>%
filter(ID %in% allBadIDs) %>%
group_by(ID) %>%
summarise(Hair_Type = unique(Hair_Type))
